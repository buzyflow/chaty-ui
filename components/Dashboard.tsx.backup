```
import React, { useState } from 'react';
import { User } from '../types';
import { Bot, Share2, MessageSquare, Settings, LogOut, Copy, Check, Package, ShoppingBag } from 'lucide-react';
import { ProductManager } from './ProductManager';
import { OrdersView } from './OrdersView';

interface DashboardProps {
    user: User;
    onStartChat: () => void;
    onEditSettings: () => void;
    onLogout: () => void;
}

export const Dashboard: React.FC<DashboardProps> = ({ user, onStartChat, onEditSettings, onLogout }) => {
    const [copied, setCopied] = useState(false);
    const [activeTab, setActiveTab] = useState<'overview' | 'products' | 'orders'>('overview');
    // Mock URL generation based on current location and user ID
    const shareUrl = `${ window.location.origin }?bot = ${ user.id } `;

    const handleCopy = () => {
        navigator.clipboard.writeText(shareUrl);
        setCopied(true);
        setTimeout(() => setCopied(false), 2000);
    };

    const getBgColor = (color: string) => {
        const map: Record<string, string> = {
            indigo: 'bg-indigo-600',
            emerald: 'bg-emerald-600',
            rose: 'bg-rose-600',
            amber: 'bg-amber-600',
            sky: 'bg-sky-600',
            violet: 'bg-violet-600'
        };
        return map[color] || 'bg-indigo-600';
    };

    return (
        <div className="min-h-screen bg-slate-50 p-6 md:p-12 font-sans animate-in fade-in duration-500">
            <div className="max-w-5xl mx-auto">

                {/* Header */}
                <div className="flex justify-between items-center mb-10">
                    <div>
                        <h1 className="text-3xl font-bold text-slate-800">Dashboard</h1>
                        <p className="text-slate-500 mt-1">Manage your AI assistant for <span className="font-semibold text-slate-900">{user.businessName}</span></p>
                    </div>
                    <button
                        onClick={onLogout}
                        className="flex items-center gap-2 text-slate-500 hover:text-red-600 px-4 py-2 rounded-lg hover:bg-red-50 transition-colors"
                    >
                        <LogOut size={18} />
                        <span className="hidden md:inline">Logout</span>
                    </button>
                </div>

                {/* Tab Navigation */}
                <div className="flex border-b border-slate-200 mb-8">
                    <button
                        onClick={() => setActiveTab('overview')}
                        className={`py - 3 px - 6 text - sm font - semibold border - b - 2 transition - colors flex items - center gap - 2 ${
    activeTab === 'overview'
    ? 'border-indigo-600 text-indigo-600'
    : 'border-transparent text-slate-500 hover:text-slate-700'
} `}
                    >
                        <Bot size={16} />
                        Overview
                    </button>
                    <button
                        onClick={() => setActiveTab('products')}
                        className={`py - 3 px - 6 text - sm font - semibold border - b - 2 transition - colors flex items - center gap - 2 ${
    activeTab === 'products'
    ? 'border-indigo-600 text-indigo-600'
    : 'border-transparent text-slate-500 hover:text-slate-700'
} `}
                    >
                        <Package size={16} />
                        Products
                    </button>
                </div>

                {activeTab === 'overview' ? (
                    <div className="grid grid-cols-1 md:grid-cols-3 gap-8">

                        {/* Bot Preview Card */}
                        <div className="md:col-span-2 bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden flex flex-col">
                            <div className="p-6 border-b border-slate-100 flex justify-between items-center bg-slate-50/50">
                                <h2 className="text-lg font-bold text-slate-800 flex items-center gap-2">
                                    <Bot className="text-indigo-600" size={20} />
                                    Your Assistant Configuration
                                </h2>
                                <span className="px-3 py-1 bg-green-100 text-green-700 text-xs font-bold rounded-full uppercase tracking-wide">Active</span>
                            </div>

                            <div className="p-8 flex flex-col md:flex-row items-center gap-8 flex-1 justify-center">
                                <div className={`w - 32 h - 32 rounded - full flex items - center justify - center shadow - xl ring - 4 ring - slate - 50 ${ getBgColor(user.botSettings.avatarColor) } `}>
                                    <Bot size={64} className="text-white" />
                                </div>
                                <div className="flex-1 text-center md:text-left space-y-3">
                                    <div>
                                        <h3 className="text-3xl font-bold text-slate-900">{user.botSettings.botName}</h3>
                                        <p className="text-slate-400 text-sm mt-1">AI Sales Assistant</p>
                                    </div>

                                    <div className="bg-slate-50 p-4 rounded-xl border border-slate-100 italic text-slate-600 text-sm relative">
                                        <span className="absolute -top-2 left-4 px-2 bg-slate-50 text-slate-400 text-xs">Welcome Message</span>
                                        "{user.botSettings.welcomeMessage}"
                                    </div>

                                    <div className="pt-4 flex flex-wrap gap-3 justify-center md:justify-start">
                                        <button
                                            onClick={onStartChat}
                                            className="px-6 py-3 bg-indigo-600 text-white rounded-xl font-semibold hover:bg-indigo-700 transition-all shadow-lg shadow-indigo-100 flex items-center gap-2 active:scale-95"
                                        >
                                            <MessageSquare size={18} />
                                            Test Chatbot
                                        </button>
                                        <button
                                            onClick={onEditSettings}
                                            className="px-6 py-3 bg-white border border-slate-200 text-slate-700 rounded-xl font-semibold hover:bg-slate-50 hover:border-slate-300 transition-all flex items-center gap-2 active:scale-95"
                                        >
                                            <Settings size={18} />
                                            Customize
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        {/* Share / Stats Column */}
                        <div className="space-y-6 flex flex-col">

                            {/* Share Link Card */}
                            <div className="bg-white rounded-2xl shadow-sm border border-slate-200 p-6 flex-1">
                                <h2 className="text-lg font-bold text-slate-800 mb-4 flex items-center gap-2">
                                    <Share2 size={20} className="text-sky-600" />
                                    Share with Customers
                                </h2>
                                <p className="text-sm text-slate-500 mb-6 leading-relaxed">
                                    Copy this link and share it on your social media or website to let customers order directly via your AI assistant.
                                </p>

                                <div className="space-y-3">
                                    <div className="bg-slate-50 border border-slate-200 rounded-lg p-3 flex items-center gap-2">
                                        <input
                                            type="text"
                                            value={shareUrl}
                                            readOnly
                                            className="bg-transparent border-none text-slate-600 text-sm flex-1 focus:ring-0 truncate font-mono"
                                        />
                                    </div>
                                    <button
                                        onClick={handleCopy}
                                        className={`w - full py - 2.5 rounded - lg text - sm font - bold transition - all flex items - center justify - center gap - 2 ${
    copied
        ? 'bg-green-600 text-white'
        : 'bg-slate-900 text-white hover:bg-slate-800'
} `}
                                    >
                                        {copied ? <Check size={16} /> : <Copy size={16} />}
                                        {copied ? 'Copied to Clipboard' : 'Copy URL'}
                                    </button>
                                </div>
                            </div>

                            {/* Quick Tip */}
                            <div className="bg-gradient-to-br from-indigo-50 to-white rounded-2xl p-6 border border-indigo-100">
                                <h3 className="font-bold text-indigo-900 mb-2 text-sm">Optimization Tip</h3>
                                <p className="text-indigo-800 text-sm leading-relaxed opacity-90">
                                    Add details about your current promotions, bestsellers, or special offers to the <strong>System Instructions</strong> to help the bot recommend them to customers!
                                </p>
                            </div>
                        </div>

                    </div>
                ) : (
                    <ProductManager userId={user.id} />
                )}
            </div>
        </div>
    );
};